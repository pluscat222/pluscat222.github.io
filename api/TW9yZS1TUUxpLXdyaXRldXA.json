{"title":"More SQLi - writeup","date":"2024-07-26T15:35:00.000Z","date_formatted":{"ll":"Jul 26, 2024","L":"07/26/2024","MM-DD":"07-26"},"author":"plusC","link":"More-SQLi-writeup","comments":true,"tags":["Web","picoCTF","picoCTF 2023"],"categories":["picoCTF"],"updated":"2024-07-26T16:16:51.640Z","content":"<h2 id=\"題目\">題目<a title=\"#題目\" href=\"#題目\"></a></h2>\n<p><img src=\"/images/pasted-38.png\" alt=\"upload successful\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"解題過程\">解題過程<a title=\"#解題過程\" href=\"#解題過程\"></a></h2>\n<p>首先看到登入畫面<br>\n<img src=\"/images/pasted-39.png\" alt=\"upload successful\" loading=\"lazy\"></p>\n<p>隨意輸入後可以看到它直接將 sql 語句印出來<br>\n<img src=\"/images/pasted-40.png\" alt=\"upload successful\" loading=\"lazy\"></p>\n<p>語句是先檢查密碼<br>\n所以密碼直接試試看最經典的 payload：<code>'or'1'='1'--</code><br>\n帳號就隨便打</p>\n<p>就成功登入了<br>\n登入看到有一個查詢的 table，這邊我卡了蠻久的<br>\n<img src=\"/images/pasted-41.png\" alt=\"upload successful\" loading=\"lazy\"></p>\n<p>後來就放棄去看提示啦<br>\n<img src=\"/images/pasted-42.png\" alt=\"upload successful\" loading=\"lazy\"></p>\n<p>提示寫說是 SQLite 有關的 injection<br>\n所以就去查了一下 SQLite 的 cheatsheet</p>\n<p><code>SELECT name FROM sqlite_master WHERE type='table'</code>: 從 SQLite 資料庫中查詢所有 table 的名稱</p>\n<p><code>SELECT sql FROM sqlite_master WHERE type='table'</code>: 從 SQLite 資料庫中查詢所有 table 的創建語句</p>\n<p>就用 Union 的方式去搜尋看看<br>\nUnion 需要符合兩個 select 的查詢欄位數量一樣，並且對應的欄位資料型態一樣或是兼容</p>\n<p>所以先觀察原本 table 的資料型態，第一個欄位 City 是 TEXT，第二個欄位 Address 也是 TEXT，第三個欄位 Phone 應該也是 TEXT</p>\n<p>設計的 payload：<br>\n<code>Algiers' union SELECT name,sql,sql FROM sqlite_master WHERE type='table'; --</code></p>\n<p>查詢結果成功拿到所有的 tables 以及它們的架構：<br>\n<img src=\"/images/pasted-43.png\" alt=\"upload successful\" loading=\"lazy\"></p>\n<p>從這些 tables 中看到有一個 table 叫做 <code>more_table</code>，並且裡面有一個欄位叫做 <code>flag</code><br>\n感覺就是這個了!!!</p>\n<p>用跟剛才一樣的方式去設計 payload：<br>\n<code>Algiers' union SELECT flag,flag,flag FROM more_table; --</code></p>\n<p>就成功拿到 flag 啦~<br>\n<img src=\"/images/pasted-44.png\" alt=\"upload successful\" loading=\"lazy\"></p>\n<p>picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_98236ce6}</p>\n<h2 id=\"參考資料\">參考資料<a title=\"#參考資料\" href=\"#參考資料\"></a></h2>\n<p><a href=\"https://github.com/unicornsasfuel/sqlite_sqli_cheat_sheet\" target=\"_blank\">https://github.com/unicornsasfuel/sqlite_sqli_cheat_sheet</a></p>\n","prev":{"title":"SQLiLite - writeup","link":"SQLiLite-writeup"},"next":{"title":"SOAP - writeup","link":"SOAP-writeup"},"plink":"https://pluscat.me/More-SQLi-writeup/","toc":[{"id":"題目","title":"題目","index":"1"},{"id":"解題過程","title":"解題過程","index":"2"},{"id":"參考資料","title":"參考資料","index":"3"}],"reading_time":"398 words in 3 min"}