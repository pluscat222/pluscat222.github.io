{"title":"Bookmarklet - writeup","date":"2024-07-24T12:32:00.000Z","date_formatted":{"ll":"Jul 24, 2024","L":"07/24/2024","MM-DD":"07-24"},"author":"plusC","link":"Bookmarklet-writeup","comments":true,"tags":["Web","picoCTF","picoCTF 2024"],"updated":"2024-07-24T12:44:34.075Z","content":"<h2 id=\"題目\">題目<a title=\"#題目\" href=\"#題目\"></a></h2>\n<p><img src=\"/images/pasted-30.png\" alt=\"upload successful\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"解題過程\">解題過程<a title=\"#解題過程\" href=\"#解題過程\"></a></h2>\n<p>題目說可以把 flag 做成書籤印出來<br>\n進到題目給的頁面後看到它說書籤就在文字框中</p>\n<p><img src=\"/images/pasted-31.png\" alt=\"upload successful\" loading=\"lazy\" class=\"φbp\"></p>\n<p>看到書籤的內容是一個 JS 的 function<br>\n功能看起來是把一個加密過的 flag 進行解密的動作然後印出來</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javascript:(function() &#123;</span><br><span class=\"line\">\tvar encryptedFlag = &quot;àÒÆÞ¦È¬ëÙ£ÖÓÚåÛÑ¢ÕÓ¨ÍÕÄ¦í&quot;;</span><br><span class=\"line\">    var key = &quot;picoctf&quot;;</span><br><span class=\"line\">    var decryptedFlag = &quot;&quot;;</span><br><span class=\"line\">    for (var i = 0; i &lt; encryptedFlag.length; i++) &#123;</span><br><span class=\"line\">    \tdecryptedFlag += String.fromCharCode((encryptedFlag.charCodeAt(i) - key.charCodeAt(i % key.length) + 256) % 256);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    alert(decryptedFlag);</span><br><span class=\"line\">&#125;)();</span><br><span class=\"line\">    </span><br></pre></td></tr></table></figure>\n<p>下意識就是把這段程式複製下來貼到 devtools 的 console 執行看看</p>\n<p><img src=\"/images/pasted-32.png\" alt=\"upload successful\" loading=\"lazy\" class=\"φbp\"></p>\n<p>就可以看到 flag 跳出來了~d(`･∀･)b<br>\n<img src=\"/images/pasted-33.png\" alt=\"upload successful\" loading=\"lazy\"></p>\n<p>picoCTF{p@g3_turn3r_18d2fa20}</p>\n","prev":{"title":"SOAP - writeup","link":"SOAP-writeup"},"next":{"title":"IntroToBurp - writeup","link":"IntroToBurp-writeup"},"plink":"https://pluscat.me/Bookmarklet-writeup/","toc":[{"id":"題目","title":"題目","index":"1"},{"id":"解題過程","title":"解題過程","index":"2"}],"reading_time":"193 words in 1 min"}